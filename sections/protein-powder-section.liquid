{% comment %}
  Protein Powder Section - Customized Protein Powder
{% endcomment %}

<section class="protein-powder-section" style="padding: 5rem 0; background-color: #f5f5f5; text-align: center;">
  <div class="container" style="max-width: 1400px; margin: 0 auto; padding: 0 1.5rem; position: relative; /* For positioning the new global arrow */">
    
    <div class="section-header" style="margin-bottom: 3rem; text-align: center;">
      <p class="section-subtitle" style="font-size: 1rem; color: #666; margin: 0 0 0.5rem; text-transform: uppercase; font-weight: 500;">{{ section.settings.subheading }}</p>
      <h2 class="section-main-heading" style="font-size: 2.5rem; font-weight: 700; color: #333; margin: 0; line-height: 1.2;">{{ section.settings.heading }}</h2>
    </div>

    <div class="protein-powder-container" style="display: flex; flex-wrap: wrap; gap: 3rem; justify-content: center; align-items: flex-start;">
      
      <div class="product-image-column" style="flex: 1; min-width: 300px; max-width: 500px; position: relative; display: flex; justify-content: center; align-items: center;">
        <button class="nav-arrow prev" style="background: none; border: none; cursor: pointer; padding: 0.5rem; position: absolute; left: -25px; top: 50%; transform: translateY(-50%); z-index: 10;">
          {% if section.settings.icon_arrow_left %}
            {{ section.settings.icon_arrow_left | image_url: width: 24 | image_tag: loading: 'lazy', alt: 'Previous Arrow', style: 'width: 24px; height: 24px; object-fit: contain;' }}
          {% else %}
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: block;"><polyline points="15 18 9 12 15 6"></polyline></svg>
          {% endif %}
        </button>
        
        <div class="product-image-carousel" style="width: 100%; max-width: 450px; height: 400px; overflow: hidden; position: relative; border-radius: 12px; background: #fff; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);">
          {% for block in section.blocks %}
            {% if block.type == 'image' %}
              <div class="product-image" {{ block.shopify_attributes }} style="display: {% if forloop.first %}flex{% else %}none{% endif %}; width: 100%; height: 100%; justify-content: center; align-items: center;">
                {% if block.settings.image %}
                  {{ block.settings.image | image_url: width: 450 | image_tag: loading: 'lazy', alt: section.settings.heading, style: 'width: 100%; height: 100%; object-fit: contain; border-radius: 12px;' }}
                {% else %}
                  <img src="{{ 'whey-protein-package-placeholder.png' | asset_url }}" loading="lazy" alt="Protein powder package" style="width: 100%; height: 100%; object-fit: contain; border-radius: 12px;" />
                {% endif %}
              </div>
            {% endif %}
          {% endfor %}
        </div>
        
        <button class="nav-arrow next" style="background: none; border: none; cursor: pointer; padding: 0.5rem; position: absolute; right: -25px; top: 50%; transform: translateY(-50%); z-index: 10;">
          {% if section.settings.icon_arrow_right %}
            {{ section.settings.icon_arrow_right | image_url: width: 24 | image_tag: loading: 'lazy', alt: 'Next Arrow', style: 'width: 24px; height: 24px; object-fit: contain;' }}
          {% else %}
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#333" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: block;"><polyline points="9 18 15 12 9 6"></polyline></svg>
          {% endif %}
        </button>
      </div>
      
      <div class="product-info-column" style="flex: 1; min-width: 300px; max-width: 600px;">
        <div class="product-details-card" style="background: #fff; border: 1px solid #e0e0e0; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05); padding: 2rem; text-align: left;">
          <div class="blend-section" style="background-color: #1A1A1A; padding: 1.5rem; border-radius: 12px 12px 0 0; margin: -2rem -2rem 1.5rem -2rem;">
            <h3 class="card-title" style="font-size: 1.5rem; font-weight: 600; color: #fff; margin: 0 0 1.5rem; text-align: center;">{{ section.settings.card_title }}</h3>
            <div class="feature-list" style="display: flex; justify-content: space-around; gap: 1rem; margin-bottom: 0;">
              {% for block in section.blocks %}
                {% if block.type == 'feature' %}
                  <div class="feature-item" {{ block.shopify_attributes }} style="display: flex; flex-direction: row; align-items: center; gap: 0.8rem; font-size: 0.9rem; color: #fff;">
                    {% if section.settings.icon_leaf %}
                      {{ section.settings.icon_leaf | image_url: width: 24 | image_tag: loading: 'lazy', alt: 'Feature Icon', style: 'width: 24px; height: 24px; object-fit: contain; filter: brightness(0) invert(1); flex-shrink: 0;' }}
                    {% else %}
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="flex-shrink: 0;"><path d="M11 20A7 7 0 0 1 9 13l-5-5A7 7 0 0 1 11 1v19z"></path><path d="M11 20h9"></path></svg>
                    {% endif %}
                    <span style="font-weight: 500;">{{ block.settings.feature_text }}</span>
                  </div>
                {% endif %}
              {% endfor %}
            </div>
          </div>
          
          <h4 class="ingredients-title" style="font-size: 1.2rem; font-weight: 600; color: #333; margin: 0 0 1.5rem;">{{ section.settings.ingredients_title }}</h4>
          
          <div class="ingredients-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; margin-bottom: 2rem;">
            {% for block in section.blocks %}
              {% if block.type == 'ingredient' %}
                <div class="ingredient-item" {{ block.shopify_attributes }} style="text-align: center;">
                  <div style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                    {% if section.settings.icon_leaf %}
                      {{ section.settings.icon_leaf | image_url: width: 24 | image_tag: loading: 'lazy', alt: 'Ingredient Icon', style: 'width: 24px; height: 24px; object-fit: contain;' }}
                    {% else %}
                      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 20A7 7 0 0 1 9 13l-5-5A7 7 0 0 1 11 1v19z"></path><path d="M11 20h9"></path></svg>
                    {% endif %}
                    <h5 style="font-size: 1rem; font-weight: 600; color: #333; margin: 0;">{{ block.settings.ingredient_name }}</h5>
                  </div>
                  <p style="font-size: 0.9rem; color: #666; margin: 0; line-height: 1.4;">{{ block.settings.ingredient_description }}</p>
                </div>
              {% endif %}
            {% endfor %}
          </div>
          
          <button class="customize-button" style="background-color: #1A1A1A; color: #fff; padding: 0.75rem 1.5rem; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: background-color 0.3s ease; width: 100%; max-width: 300px; display: block; margin: 0 auto; font-size: 1rem;">{{ section.settings.button_text }}</button>
        </div>
      </div>
    </div>

    <button class="global-next-arrow" title="Next" aria-label="Next" style="background: none; border: none; cursor: pointer; padding: 1rem; position: absolute; right: 5px; /* Adjust distance from edge of container */ top: 50%; transform: translateY(-50%); z-index: 20;">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="#777" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display:block;"><polyline points="9 18 15 12 9 6"></polyline></svg>
    </button>

  </div>

  <style>
    @media (max-width: 250px) {
      .protein-powder-section { padding: 2rem 0; }
      .container { padding: 0 0.5rem; }
      .global-next-arrow { display: none; /* Hide global arrow on very small screens */ }
      .protein-powder-container { flex-direction: column; gap: 1.5rem; }
      .product-image-column { min-width: 200px; }
      .product-image-carousel { max-width: 100%; height: 200px; }
      .nav-arrow { padding: 0.25rem; left: 5px; right: 5px; transform: translateY(-50%);}
      .nav-arrow.prev { left: 5px; }
      .nav-arrow.next { right: 5px; }
      .nav-arrow svg, .nav-arrow img { width: 16px; height: 16px; }
      .product-info-column { min-width: 100%; max-width: 100%; }
      .section-header .section-subtitle { font-size: 0.8rem; }
      .section-header .section-main-heading { font-size: 1.5rem; }
      .product-details-card { padding: 1rem; }
      .blend-section { padding: 0.5rem; margin: -1rem -1rem 1rem -1rem; }
      .card-title { font-size: 1.2rem; }
      .feature-list { gap: 0.5rem; flex-wrap: wrap; flex-direction: column; align-items: center; } /* Stack features on smallest screens */
      .feature-item { font-size: 0.7rem; flex-direction: row !important; /* Keep horizontal for icon-text */ }
      .feature-item img, .feature-item svg { width: 16px; height: 16px; }
      .ingredients-title { font-size: 1rem; }
      .ingredients-grid { grid-template-columns: 1fr; gap: 1rem; }
      .ingredient-item h5 { font-size: 0.9rem; }
      .ingredient-item p { font-size: 0.7rem; }
      .ingredient-item img, .ingredient-item svg { width: 16px; height: 16px; }
      .customize-button { font-size: 0.8rem; padding: 0.5rem 1rem; max-width: 200px; }
    }

    @media (min-width: 251px) and (max-width: 576px) {
      .protein-powder-section { padding: 3rem 0; }
      .container { padding: 0 1rem; }
      .global-next-arrow { display: none; /* Hide global arrow */ }
      .protein-powder-container { flex-direction: column; gap: 2rem; }
      .product-image-column { min-width: 250px; }
      .product-image-carousel { max-width: 100%; height: 250px; }
      .nav-arrow { padding: 0.35rem; left: 5px; right: 5px; transform: translateY(-50%);}
      .nav-arrow.prev { left: 5px; }
      .nav-arrow.next { right: 5px; }
      .nav-arrow img, .nav-arrow svg { width: 20px; height: 20px; }
      .product-info-column { min-width: 100%; max-width: 100%; }
      .section-header .section-subtitle { font-size: 0.9rem; }
      .section-header .section-main-heading { font-size: 2rem; }
      .product-details-card { padding: 1.5rem; }
      .blend-section { padding: 1rem; margin: -1.5rem -1.5rem 1rem -1.5rem; }
      .card-title { font-size: 1.3rem; }
      .feature-list { gap: 1rem; /* Increased gap for better spacing when horizontal */ justify-content: center; flex-wrap: wrap; }
      .feature-item { font-size: 0.8rem; }
      .feature-item img, .feature-item svg { width: 18px; height: 18px; }
      .ingredients-title { font-size: 1.1rem; }
      .ingredients-grid { grid-template-columns: 1fr; gap: 1.5rem; }
      .ingredient-item h5 { font-size: 0.95rem; }
      .ingredient-item p { font-size: 0.8rem; }
      .ingredient-item img, .ingredient-item svg { width: 18px; height: 18px; }
      .customize-button { font-size: 0.9rem; padding: 0.6rem 1.2rem; max-width: 250px; }
    }

    @media (min-width: 577px) and (max-width: 768px) {
      .protein-powder-section { padding: 4rem 0; }
      .global-next-arrow { right: 10px; } /* Adjust global arrow for tablet */
      .protein-powder-container { flex-direction: column; gap: 2.5rem; }
      .product-image-column { min-width: 300px; margin: 0 auto; max-width: 400px; }
      .product-image-carousel { max-width: 100%; height: 300px; }
      .nav-arrow { padding: 0.5rem; left: -15px; right: -15px; transform: translateY(-50%);}
      .nav-arrow.prev { left: -15px; }
      .nav-arrow.next { right: -15px; }
      .nav-arrow img, .nav-arrow svg { width: 22px; height: 22px; }
      .product-info-column { min-width: 100%; max-width: 100%; }
      .section-header .section-subtitle { font-size: 0.95rem; }
      .section-header .section-main-heading { font-size: 2.2rem; }
      .product-details-card { padding: 1.75rem; }
      .blend-section { padding: 1.25rem; margin: -1.75rem -1.75rem 1rem -1.75rem; }
      .card-title { font-size: 1.4rem; }
      .feature-list { gap: 1.5rem; justify-content: space-around; }
      .feature-item { font-size: 0.85rem; }
      .feature-item img, .feature-item svg { width: 20px; height: 20px; }
      .ingredients-title { font-size: 1.15rem; }
      .ingredients-grid { grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.75rem; }
      .ingredient-item h5 { font-size: 1rem; }
      .ingredient-item p { font-size: 0.85rem; }
      .customize-button { font-size: 1rem; padding: 0.7rem 1.4rem; }
    }
    
    @media (min-width: 769px) {
      .protein-powder-container { flex-direction: row; align-items: flex-start; }
      .product-image-column { flex: 0 1 450px; max-width: 450px; }
      .product-image-carousel { max-width: 100%; height: 400px; }
      .product-info-column { flex: 1 1 50%; max-width: 600px; }
      .nav-arrow.prev { left: -25px; }
      .nav-arrow.next { right: -25px; }
      .global-next-arrow { right: 15px; /* Default for larger screens */ }
      .ingredients-grid { grid-template-columns: repeat(3, 1fr); }
    }
    
    @media (min-width: 769px) and (max-width: 1024px) {
      .protein-powder-section { padding: 4rem 0; }
      .protein-powder-container { gap: 2.5rem; }
      .product-image-column { flex-basis: 400px; max-width: 400px; }
      .product-image-carousel { height: 350px; }
      .nav-arrow img, .nav-arrow svg { width: 24px; height: 24px; }
      .section-header .section-subtitle { font-size: 1rem; }
      .section-header .section-main-heading { font-size: 2.5rem; }
      .product-details-card { padding: 2rem; }
      .blend-section { padding: 1.5rem; margin: -2rem -2rem 1.5rem -2rem; }
      .card-title { font-size: 1.5rem; }
      .feature-list { gap: 1rem; }
      .feature-item { font-size: 0.9rem; }
      .ingredients-title { font-size: 1.2rem; }
      .ingredients-grid { gap: 2rem; }
      .ingredient-item h5 { font-size: 1rem; }
      .ingredient-item p { font-size: 0.9rem; }
      .customize-button { font-size: 1rem; padding: 0.75rem 1.5rem; }
    }

    @media (min-width: 1025px) {
      .protein-powder-container { gap: 3rem; }
      .product-image-column { flex-basis: 450px; max-width: 450px; }
      .product-image-carousel { max-width: 400px; height: 400px; }
      .product-info-column { min-width: 400px; max-width: 600px; }
      .section-header .section-main-heading { font-size: 2.5rem; }
      .feature-list { gap: 1rem; }
      .ingredients-grid { gap: 2rem; }
    }

    @media (min-width: 1440px) { /* Adjust global arrow for very wide screens if container is not full width */
        .global-next-arrow {
            /* Calculate position if container is not viewport width, e.g. right: calc((100vw - 1400px) / 2 + 15px); */
            /* For simplicity, if container is max-width and centered, this might be okay or need adjustment based on actual render */
             right: 30px; /* Example */
        }
    }


    @media (min-width: 2001px) {
      .protein-powder-section { padding: 6rem 0; }
      .global-next-arrow { right: 40px; /* Further out for very large screens */ }
      .protein-powder-container { gap: 4rem; }
      .product-image-column { flex-basis: 550px; max-width: 550px; }
      .product-image-carousel { max-width: 500px; height: 500px; }
      .nav-arrow { padding: 0.75rem; }
      .nav-arrow.prev { left: -30px; }
      .nav-arrow.next { right: -30px; }
      .nav-arrow img, .nav-arrow svg { width: 28px; height: 28px; }
      .product-info-column { min-width: 500px; max-width: 700px; }
      .section-header .section-subtitle { font-size: 1.2rem; }
      .section-header .section-main-heading { font-size: 3rem; }
      .product-details-card { padding: 2.5rem; }
      .blend-section { padding: 2rem; margin: -2.5rem -2.5rem 1.5rem -2.5rem; }
      .card-title { font-size: 1.8rem; }
      .feature-list { gap: 1.5rem; }
      .feature-item { font-size: 1rem; }
      .feature-item img, .feature-item svg { width: 24px; height: 24px; }
      .ingredients-title { font-size: 1.4rem; }
      .ingredients-grid { gap: 2.5rem; }
      .ingredient-item h5 { font-size: 1.2rem; }
      .ingredient-item p { font-size: 1rem; }
      .ingredient-item img, .ingredient-item svg { width: 24px; height: 24px; }
      .customize-button { font-size: 1.2rem; padding: 1rem 2rem; max-width: 350px; }
    }
  </style>
</section>

{% schema %}
{
  "name": "Protein Powder Section",
  "settings": [
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading (Centered above columns)",
      "default": "Simple & Effective Ingredients"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading (Centered above columns)",
      "default": "Customized Protein Powder"
    },
    {
      "type": "text",
      "id": "card_title",
      "label": "Card Title (e.g., The Blend)",
      "default": "The Blend"
    },
    {
      "type": "text",
      "id": "ingredients_title",
      "label": "Ingredients Title",
      "default": "Active Ingredients"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Customize This Blend"
    },
    {
      "type": "image_picker",
      "id": "icon_arrow_left",
      "label": "Arrow Left Icon (Image Carousel)",
      "info": "Upload a custom left arrow icon for the carousel navigation (recommended size: 24x24px)."
    },
    {
      "type": "image_picker",
      "id": "icon_arrow_right",
      "label": "Arrow Right Icon (Image Carousel)",
      "info": "Upload a custom right arrow icon for the carousel navigation (recommended size: 24x24px)."
    },
    {
      "type": "image_picker",
      "id": "icon_leaf",
      "label": "Leaf Icon",
      "info": "Upload a custom leaf icon for features and ingredients (recommended size: 24x24px)."
    }
  ],
  "blocks": [
    {
      "name": "Image",
      "type": "image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        }
      ]
    },
    {
      "name": "Feature",
      "type": "feature",
      "settings": [
        {
          "type": "text",
          "id": "feature_text",
          "label": "Feature Text",
          "default": "Whey Based"
        }
      ]
    },
    {
      "name": "Ingredient",
      "type": "ingredient",
      "settings": [
        {
          "type": "text",
          "id": "ingredient_name",
          "label": "Ingredient Name",
          "default": "Whey Protein Isolate"
        },
        {
          "type": "textarea",
          "id": "ingredient_description",
          "label": "Ingredient Description",
          "default": "Low Calorie With Virtually No Fat or Lactose, Quickly Absorbed To Maximize Muscle Building & Repair."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Protein Powder Section",
      "category": "Custom Content",
      "blocks": [
        {
          "type": "image",
          "settings": {}
        },
        {
          "type": "feature",
          "settings": {
            "feature_text": "Whey Based"
          }
        },
        {
          "type": "feature",
          "settings": {
            "feature_text": "Build Muscle"
          }
        },
        {
          "type": "feature",
          "settings": {
            "feature_text": "Clean Ingredients"
          }
        },
        {
          "type": "ingredient"
        },
        {
          "type": "ingredient"
        },
        {
          "type": "ingredient"
        }
      ]
    }
  ]
}
{% endschema %}